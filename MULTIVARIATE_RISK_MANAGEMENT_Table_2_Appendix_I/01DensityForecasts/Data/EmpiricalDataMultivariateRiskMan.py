#!/usr/bin/env python3# -*- coding: utf-8 -*-## Imports# Fundamentalsimport numpy as np  # Systemimport pandas as pd# Download data from Yahoo Financeimport yfinance as yf        ###########################################################  def main():            ## Magic numbers    sStart = "1999-01-01"    sEnd = '2023-12-31'         ## XLE    # Returns    dfClosingPrices = yf.download('XLE', start=sStart, end=sEnd,  auto_adjust=False)['Adj Close']    dfReturns = np.log(dfClosingPrices[1:]) - np.log(dfClosingPrices.shift(1)[1:])        # Add RV data    dfRMAllFullPeriod = pd.read_csv('RVFullPeriodXLETrade.csv')    dfRMAllFullPeriod['Date'] = pd.to_datetime(dfRMAllFullPeriod['Date'])    dfRMAllFullPeriod.set_index('Date', inplace=True)    dfRMAllFullPeriod.sort_index(inplace=True)    dfRMFullPeriod = dfRMAllFullPeriod['Volatility']     dfRMa = dfRMFullPeriod.loc[sStart:sEnd]    dfRM= pd.DataFrame(data=(dfRMa.values**2)/252, index=dfRMa.index, columns=['rv'])    # Merge data    dfData = dfReturns.merge(dfRM, left_index=True, right_index=True, how='inner')     dfData.to_csv('XLEandRealVolXiu.csv')        ## XLF    # Returns    dfClosingPricesB = yf.download("XLF", start=sStart, end=sEnd,  auto_adjust=False)['Adj Close']    dfReturns = np.log(dfClosingPrices[1:]) - np.log(dfClosingPrices.shift(1)[1:])        # Add RV data    dfRMAllFullPeriod = pd.read_csv('RVFullPeriodXLFTrade.csv')    dfRMAllFullPeriod['Date'] = pd.to_datetime(dfRMAllFullPeriod['Date'])    dfRMAllFullPeriod.set_index('Date', inplace=True)    dfRMAllFullPeriod.sort_index(inplace=True)    dfRMFullPeriod = dfRMAllFullPeriod['Volatility']     dfRMa = dfRMFullPeriod.loc[sStart:sEnd]    dfRM= pd.DataFrame(data=(dfRMa.values**2)/252, index=dfRMa.index, columns=['rv'])    # Merge data    dfData = dfReturns.merge(dfRM, left_index=True, right_index=True, how='inner')     dfData.to_csv('XLFandRealVolXiuC.csv')